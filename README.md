# 思路
1.如何保证生产者发送的消息正确的送到了队列?

解决办法: 采用MQ消息确认机制。Confirm机制

2.生产者发送消息成功后,消费者消费失败了，该怎么做?

注意幂等性: 1个生产者，多个消费者,其中一个消费者出现，消息重新分发，避免重复消费问题。
采用消息重试机制，手动Ack,注意重试幂等性问题。

3.如何保证第一个事务先执行，采用补偿机制（补单机制），在创建一个补单消费者进行监听，如果订单没有创建成功，进行补单

生产者发送消息成功了,数据库里插入的记录，消费者收到消息，也消费成功了，生产者突然报错了，该怎么办?

解决办法:

生产者开启了事务，会进行回滚，但是消费者数据已经插入了。

生产者发送消息时，消息同时发送到2个队列里面，一个是消费队列，一个是消费的补偿队列。

消费队列正常消费。

消费补偿队列:用了确保生产者数据的一致性问题。补偿队列，根据唯一id查询数据库，如果没有查询到生产者
数据库创建的记录，则进行重新创建操作，如果查询到了，说明生产者是成功的，什么都不做。